 ----------------------------------------------------------------------
    Input data for DUSTY                                               
 ---------------------------------------------------------------------- 
 This is an input file for radiative transfer code DUSTY, version 2.08. 
 NOTE: this input file is not compatible with old versions of Dusty 
 due to the added new input options. Examples of each input option are 
 given at the end of this file. For a more detailed description please 
 refer to the Manual. 
 
 This input file has a free format. Text and empty lines can be entered
 arbitrarily. The relevant numerical input, entered in standard FORTRAN 
 conventions, is flagged by the equal sign. The only restrictions are 
 that all required input entries must be specified, and in the correct 
 order, as shown in the template input files. The most likely source 
 of an input error is failure to comply with these requirements. 
 Single entries are always preceded by the equal sign and terminated 
 by a blank, which can be optionally preceded with a punctuation mark. 
 Some input is entered as a list, in which case only the first member 
 is preceded by the equal sign, while each following member must be preceded 
 by a blank (a comma, followed by a blank can be entered for additional 
 separation). Because of the special role of the equal sign as a flag for 
 input entry, care must be taken not to introduce any equal signs except 
 when required. All text following the `%' sign is ignored (as in TeX) 
 and this can be used to comment out material that includes equal signs. 
 All lines that start with the `*' sign are printed out in the output.
* ----------------------------------------------------------------------
* NOTES:                                                                
* This is a more complicated version of an input file for planar geometry: 
* a slab, illuminated from both sides. 
* ----------------------------------------------------------------------

   I. GEOMETRY      
%(available options: sphere\slab)
     
	  flag = slab       % slab
                                                                        
  II. PHYSICAL PARAMETERS                                                 
     1) Source(s)   
%(available options: on\off)

         Left = on                Right = on

        (flag can be 1 or 0 for source presence or absence)

      1.1 Left-side source radiation:   

%(available options: black_body\engelke_marengo\power_law\file_lambda_f_lambda\file_f_lambda\file_f_nu) 

          Spectral shape:     Spectrum = black_body
                          Number of BB = 1      
                           Temperature = 5000.0 K 
    
%(available options: flux\lum_r1\energy_den\dilutn_fac\T1)

          Scale:         type of entry = flux     
                                    Fi = 1.0e5 %W/m2

%(available options direcitonal/isotropic.)

                  kind of illumination = directional
            illumination angle theta_L = 30.0  % degrees


      1.2 Right-side source radiation: 
          Spectral shape:     Spectrum = black_body   
                          Number of BB = 1
                           Temperature = 3000.0 K 

                  kind of illumination = directional
            illumination angle theta_R = 0.0  % degrees

           Scale:  relative bol.flux R = 0.5
 


     2) Dust Properties 
%(available options: common_grain\common_and_addl_grain\tabulated)
     
      2.1 Chemical composition                       
           optical properties index = common_grain
           Abundances for supported grain types:
               Sil-Ow  Sil-Oc  Sil-DL  grf-DL  amC-Hn  SiC-Pg 
           x =  0.00    0.00    0.53    0.47    0.00    0.00
       
      2.2 Grain size distribution
%(available options: mrn\modified_mrn\kmh)

        - size distribution = mrn  % standard MRN                         
                                                                        
       
     3) Optical Depth     
%(available options: linear\logarithmic\user_supplied)
       
        - grid type = user_supplied                      % from a file
             taugrid.dat
  ----------------------------------------------------------------------
                                                                       
  III. NUMERICS                                                           
      
     - accuracy for flux conservation = 0.10
     - starting optical depth = 1.0
     - increment in optical depth = 2.0
  ----------------------------------------------------------------------
                                                                        
  IV. OUTPUT PARAMETERS                                                 

	The flags controlling file production are as follows: 
    If flag.eq.0 the particular file(s) is not produced. If flag.eq.1
	all model results are in corresponding files with extensions 'spp' 
	(sp.properties), 'stb' (spectra), 'itb' (images and visibilities, 
	if chosen), 'rtb' (radial profiles) and 'mtb' (messages).  If 
	flag.eq.2, each model result is in a separate file, with corresponding 
	extensions 's###', 'i##', 'r##', or 'm##'. In this case the 
	visibilities are in file 'fname.i##' if the latter is selected. If the 
	images flag.eq.3 the visibilities will be in separate files 'fname.v##' 
	(the flag for visibilities has to be the same as for images).
	Note that choosing imaging output requires entry of additional input 
	(please refer to the examples below or to the Manual).
                                                                        
        FILE DESCRIPTION                               FLAG        
       ------------------------------------------------------------     
       - properties of emerging spectra;             fname.spp = 1    
       - detailed spectra for each model;           fname.s### = 2   
       - intensity output at given angles           fname.i### = 2
         theta_out (degrees):
             - angular grid type = 3         % grid from a file
               slab_ang_grid_4.dat
       - radial profiles for each model;            fname.r### = 2   
       - detailed run-time messages;                fname.m### = 2
       ------------------------------------------------------------- 
 

  The end of the input parameters listing.                                                                       
  **********************************************************************
  EXAMPLES OF INPUT:
  ----------------------------------------------------------------------
   I. GEOMETRY

    Spherical or plane-parallel calculation, chosen by the corresponding word flag:

     flag = slab  or   flag = sphere
                                                                        
  II. PHYSICAL PARAMETERS                       
                            
   1) SOURCE(S) - here the user chooses the sources illuminating 
   the spherical shell (plane-parallel slab). It is selected by an on / off flag.
   Example:

        central = on       external = off
                                                                      
  1.1 CENTRAL SOURCE RADIATION
      The central source is specified by the spectral profile and scale of its emission. 
	  
	  SPECTRUM:
	  Six input options, flag selected, are available. Three involve entry in analytical form: 
	  a combination of black-bodies, a modified black body as Engelke-Marengo function, 
	  and a step-wise power law. The other three are for entry in numerical form as a separate 
	  user-supplied input file which lists lambda*F_lambda (= nu*F_nu), F_lambda, or F_nu, vs. lambda. 
	  Here lambda is wavelength in microns, and nu is the corresponding frequency. 
	  F_lambda or F_nu is the source flux density in arbitrary units. 
	  Examples of the different options are as follows:

      (1) Two black bodies, e.g. a binary system, with specified relative luminosities:
                Spectrum = black_body               
            Number of BB =  2                
            Temperatures = 10000, 2500 K   
            Luminosities = 4, 1              

      (2) Modified black body spectrum using Engelke-Marengo function
                Spectrum = engelke_marengo                 
                     Tbb = 2500 K                  
       SiO feature depth = 10.0 % 
	   
      (3) A flat spectrum confined between 0.1 and 1.0 microns:
                Spectrum = power_law                  
                       N = 1                  
                  lambda = 0.1, 1 micron      
                       k = 0                  

      (4) Spectrum tabulated in file 'AGN.dat':
                Spectrum = file_lambda_f_lambda   
                 AGN.dat

      Options (5) and (6) are entered analogously to option (4), except that 
	  the units for option (5) are F_lambda, and for (6) are F_nu.

                Spectrum = file_f_lambda

				or 
				
				Spectrum = file_f_nu

      SCALE OF SOURCE EMISSION:
      This depends on the chosen boundary condition - either dust temperature 
	  at the inner boundary, or input flux. See the examples below.
	  
	  If the source input spectrum is from a file (see options 4,5,6 above)
	  its bolometric flux is calculated by DUSTY from the supplied file. 
	  The ONLY required input flag then is either Td at the inner boundary,
	  or a normalization factor (dilutn_fac) for the entered spectrum.
	  Examples of these options are as follows:    

	  Scale:   
	  (1) Td at the inner boundary : 
	           type of entry = T1     
                          Td = 1000   K

	  (2) External flux at the inner boundary in W/m^2: 
	           type of entry = flux     
                          Fi = 1.0e4 W/m2
	  
	  (3) Luminosity of the central source (in units of Lo) and its distance 
	      to the inner boundary (r1, in cm): 
	           type of entry = lum_r1     
                           L = 1.0e4  Lo
                          r1 = 1.0e14 cm


  1.2 EXTERNAL SOURCE RADIATION
      The external radiation is considered isotropic and specified by 
	  its spectral shape and mean energy density. Analytical spectral profiles
	  are entered in the same way as for the central source. Then the scale 
	  is given by either the value of mean intensity, or the dilution factor.
	  
	  Examples:
         Scale: 
		  (1) Energy density (mean intensity) Jo in [W/m2])
	            type of entry = energy_den     
                           Jo = 1.0e-05

      
	  (2) dilution factor W, if the source parameters are chosen as a 
	  black body. For a combination of black-bodies the dilution factor 
	  refers to the highest luminosity black body, since their relative 
	  luminosities are entered before that: 

               Scale:   type of entry = dilutn_fac         % dilution factor
                                    W = 1.0e-13    
   
	  If the spectrum is from a file there is only one option for scale: 
	  Type of entry = dilutn_fac, which multiplies the spectrum from the file; 
	  if  W = 1 the file is taken as is. 
      
	  Example of external source with data for the Interstellar radiation field 
	  in file 'ISRF.dat'. Jo is found from the file and multiplied by 20:

         Spectral shape:     Spectrum = file_lambda_f_lambda  % user spectrum in [W/m^2]
                             ISRF.dat						              

         Scale:         type of entry = dilutn_fac   
                                    W = 20          
        
      

   2) DUST PROPERTIES
   %(available options: common_grain\common_and_addl_grain\tabulated)

      Dust optical properties are determined by the sizes of the grains 
      and by their absorption and scattering efficiencies, which depend 
      also on the grain material. The grains chemical composition is 
      specified first, followed by the size distribution and the dust 
      temperature at the inner boundary.

   2.1 Chemical composition                                          
      
      DUSTY contains data for the optical properties of 6 common grain 
      types. Optical properties for additional grains can be supplied by
      the user.  In this case, the user can either specify directly the 
      absorption and scattering coefficients or have DUSTY calculate 
      them from provided index of refraction. Examples:

      (1) Mixture containing only dust grains with built-in data for
          optical properties:

                Optical properties index = common_grain
                Abundances for supported grain types:
                Sil-Ow  Sil-Oc  Sil-DL  grf-DL  amC-Hn   SiC-Pg 
            x =  0.00    0.00    0.53    0.47    0.00     0.00

      (2) Three additional grain types with the refractive index 
          provided by the user in data files amC-zb1.nk, amC-zb2.nk and
          amC-zb3.nk:
                Optical properties index = common_and_addl_grain
                Abundances for supported grain types:
                Sil-Ow  Sil-Oc  Sil-DL  grf-DL  amC-Hn   SiC-Pg 
            x =  0.00    0.00    0.00    0.35    0.00     0.00

          Number of additional components = 3, properties listed in:
                     amC-zb1.nk
                     amC-zb2.nk
                     amC-zb3.nk
          Abundances for these components = 0.45, 0.10, 0.23 
       
      (3) Absorption and scattering cross sections from the file 
          ism-stnd.dat (in this case skip the entry for size distribution)

          Optical properties index = tabulated    %cross-sections entered in file
                     ism-stnd.dat 
 
   2.2 Grain size distribution            
                                                                        
      The grain size distribution must be specified only when the 
      previous option was set to 1 or 2.  When the dust cross sections 
      are read from a file previous option set at 3, the present option 
      is skipped. Examples:
      
      (1) Standard MRN distribution. No input required other than the
          option flag.
          
          Size distribution = mrn
 
      (2) Modified MRN distribution. The option flag is followed by 
          listing of the power index, q, lower limit a(min) and upper 
          limit a(max) for sizes (in microns), chosen by the user. 
		  This option can be used, for instance, to choose single size grains, 
		  as shown in this example:

          Size distribution = modified_mrn
          q = 0.0, a(min) = 0.1 micron, a(max) = 0.1 micron 

      (3) KMH distribution. The option flag is followed by a list of 
          the power index, q, lower limit a(min) and the characteristic 
          size a0 in microns
          
          Size distribution = kmh
          q = 3.5, a(min) = 0.005 micron, a0 = 0.2 micron

                                             
   3) Density Distribution - only for spherical shell (not for slab option)

      DUSTY provides 3 methods for entering the density distribution: 
      prescribed analytical forms, hydrodynamic calculation of winds 
      driven by radiation pressure on dust particles, and numerical 
      tabulation in a file. Examples:                                          
                                              
      (1) Piecewise power law:                                        

                   density type = powd
                              N = 3
               transition radii =   10   100    1000
               power indices    =    2     1       0   
          
          Or for a single power-law:
          
               density type = powd; N = 1; Y = 1000.0; p = 2.0
          
                                              
      (2) Exponentially decreasing density distribution 
	  (the analytical expression is given in the Manual):

               density type = expd; Y = 100.0; sigma = 4.                                    
                                                        
      (3) Full numerical solution for radiatively driven winds:

               density type = rdw;     Y = 1.0e4                                             
                                                        
                                                        
      (4) Analytical approximation for radiatively driven winds:

               density type = rdwa;     Y = 1.0e4                                           
                                                        
                                                        
      (5) Density profile tabulated in a file:

               density type = user_supplied
               collapse.dat
      
   4) Optical Depth
                            
      For a given set of the parameters specified above, DUSTY can 
      generate up to 999 models covering a range of optical depths tau0, 
      specified at some fiducial wavelength lambda0. DUSTY will cover 
      this range taking either linear or logarithmic steps. The user 
      specifies the grid type: 1 for linear, 2 for logarithmic and 3 for 
      tau-grid from a file. This is followed by lambda0, the end points of 
      the tau0 range and the number of grid points. In the case of file  
      supplied grid the only entry is the file name. 
	  
%(available options: linear\logarithmic\user_supplied)

	  Example:
                grid type = logarithmic
                lambda0 = 0.55 micron
                tau(min) = 0.1; tau(max) = 10.0
                number of models = 3
                           
	  Example of a user supplied optical depth grid::
                grid type = user_supplied
                lambda0 = 0.55 micron
                   tau_grid.dat

                            
  III. NUMERICS                                                           
                            
     The numerical accuracy and convergence of DUSTY calculations are 
     controlled by a parameter specifying the required accuracy of 
     bolometric flux conservation, qacc.  The radial grid is refined 
     until the relative error of flux conservation at every point of 
     the radial grid is less than qacc. When DUSTY calculates density profile, 
	 the numerical accuracy of that calculation is controlled by the same 
	 parameter. The recommended values are:                          
      
     - accuracy for flux conservation = 0.05
     - accuracy for Temperature fluctuation  = 1e-3
     - starting optical depth = 1.0
     - increment in optical depth = 2.0

                            
  IV) OUTPUT CONTROL FLAGS                       
                                                        
     A typical DUSTY run generates an enormous amount of information, 
     and the user is in control of the volume of output. For an input
     file 'fname.inp' the default output is written to 'fname.out'. 
     Additional output can be controlled by five flags that turn on and
     off the tabulation of various quantities for each of the optical 
     depths included in the run. 
		If flag = 0 the particular file(s) is not produced. 
		If flag = 1 all model results are in corresponding files with 
	 extension 'stb' for spectra, 'itb' for images and visibilities, 
	 'rtb' for radial profiles and 'mtb' for messages. 
	    If flag = 2 each model result is in  a corresponding file, with 
	 visibilities contained in fname.i###. If the images flag = 3 
	 the visibilities will be in separate files fname.v### .The visibility flag 
	 must be the same as the images flag. The spectral properties of all model 
	 spectra are in the file fname.spp which is the same for all flag values.

     For example, the set of flags below will produce the following output 
	 files: sp.properties in 'fname.spp'; one file 'fname.stb' with all model 
	 spectra; one file with images and visibilities 'fname.itb'. The radial 
	 profiles and messages for all models will be in separate files 
	 fro each optical depth, 'fname.r##' and 'fname.m##'.


         FILE DESCRIPTION                               FLAG        
       ------------------------------------------------------------     
       - properties of emerging spectra;             fname.spp = 1     
       - detailed spectra for each model;           fname.s### = 1   
       - images at specified wavelengths;           fname.i### = 1  
         If this flag is set to 1, here specify these wavelengths: 
         the first entry is the number of such wavelengths (<20), 
         followed by a list of these wavelengths in microns.                             
         number of wavelengths  = 8                                                 
         wavelengths = 0.55, 1, 2.2, 4, 10, 50, 100, 1000 microns   
         If the flag is set to 0 delete the above two lines, or 
         delete the equal signs.                                 
       - visibility function at spec. wavelengths;  fname.v### = 1                                        
       - radial profiles for each model;            fname.r### = 2   
       - detailed run-time messages;                fname.m### = 2
       ------------------------------------------------------------- 
                                                                        
  ----------------------------------------------------------------------
     The end of the input file.                                          
  **********************************************************************
                                                                        
                                                                        
